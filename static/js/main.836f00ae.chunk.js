(this["webpackJsonpchess-sim"]=this["webpackJsonpchess-sim"]||[]).push([[0],{17:function(e,t,n){},18:function(e,t,n){},19:function(e,t,n){},28:function(e,t,n){"use strict";n.r(t);var a,i=n(2),r=n.n(i),c=n(11),o=n.n(c),p=(n(17),n(0)),s=(n(18),n(19),n(1)),l=new Map([[0,8],[1,7],[2,6],[3,5],[4,4],[5,3],[6,2],[7,1]]),u=new Map([[0,"a"],[1,"b"],[2,"c"],[3,"d"],[4,"e"],[5,"f"],[6,"g"],[7,"h"]]),f=function(e){var t=Object(i.useMemo)((function(){return Array(64).fill(0).map((function(e,t){var n=t%8,a=Math.floor(t/8);return[u.get(n),l.get(a)]}))}),[]);return Object(s.jsxs)("div",{className:"ChessBoard",children:[Array(8).fill(0).map((function(t,n){return Object(s.jsx)("div",{className:"ChessBoard__Cell ChessBoard__Perspective".concat(e.perspective," ChessBoard__RankIndicator ChessBoard__Rank").concat(l.get(n)),children:l.get(n)},"ri".concat(n))})),Array(8).fill(0).map((function(t,n){var a;return Object(s.jsx)("div",{className:"ChessBoard__Cell ChessBoard__Perspective".concat(e.perspective," ChessBoard__FileIndicator ChessBoard__File").concat(null===(a=u.get(n))||void 0===a?void 0:a.toUpperCase()),children:u.get(n)},"fi".concat(n))})),t.map((function(t){var n=Object(p.a)(t,2),a=n[0],i=n[1],r=e.chessGame.getPositionProperties(a,i);return Object(s.jsx)("div",{className:"ChessBoard__Cell ChessBoard__Perspective".concat(e.perspective," ChessBoard__File").concat(a.toUpperCase()," ChessBoard__Rank").concat(i),style:{backgroundColor:r.backgroundColor},onClick:function(){return e.onCellClick(a,i)},children:r.renderedPiece},"".concat(a).concat(i))}))]})},d=n(3),b=n(7),h=n(12),v=Object.freeze([{type:"rook",file:"a",rank:1,player:"white"},{type:"knight",file:"b",rank:1,player:"white"},{type:"bishop",file:"c",rank:1,player:"white"},{type:"queen",file:"d",rank:1,player:"white"},{type:"king",file:"e",rank:1,player:"white"},{type:"bishop",file:"f",rank:1,player:"white"},{type:"knight",file:"g",rank:1,player:"white"},{type:"rook",file:"h",rank:1,player:"white"},{type:"pawn",file:"a",rank:2,player:"white"},{type:"pawn",file:"b",rank:2,player:"white"},{type:"pawn",file:"c",rank:2,player:"white"},{type:"pawn",file:"d",rank:2,player:"white"},{type:"pawn",file:"e",rank:2,player:"white"},{type:"pawn",file:"f",rank:2,player:"white"},{type:"pawn",file:"g",rank:2,player:"white"},{type:"pawn",file:"h",rank:2,player:"white"},{type:"rook",file:"a",rank:8,player:"black"},{type:"knight",file:"b",rank:8,player:"black"},{type:"bishop",file:"c",rank:8,player:"black"},{type:"queen",file:"d",rank:8,player:"black"},{type:"king",file:"e",rank:8,player:"black"},{type:"bishop",file:"f",rank:8,player:"black"},{type:"knight",file:"g",rank:8,player:"black"},{type:"rook",file:"h",rank:8,player:"black"},{type:"pawn",file:"a",rank:7,player:"black"},{type:"pawn",file:"b",rank:7,player:"black"},{type:"pawn",file:"c",rank:7,player:"black"},{type:"pawn",file:"d",rank:7,player:"black"},{type:"pawn",file:"e",rank:7,player:"black"},{type:"pawn",file:"f",rank:7,player:"black"},{type:"pawn",file:"g",rank:7,player:"black"},{type:"pawn",file:"h",rank:7,player:"black"}]),y=function(e){return[].concat.apply([],e)},k=[{name:"Pawn Quick Start",pieceType:"pawn",apply:function(e,t){if(!(e.moveHistory.length>0)){var n=O(t,[e.file,e.rank],[0,"white"===e.player?1:-1],2);if(2===n.length){var a=Object(p.a)(n,2),i=Object(p.a)(a[1],2),r=i[0],c=i[1];e.possibleMoves.push({movedPieces:[{piece:e,from:[e.file,e.rank],to:[r,c]}],capturedPieces:[]})}}}},{name:"Pawn Standard Movement",pieceType:"pawn",apply:function(e,t){var n="white"===e.player?7:1;if(e.rank!==n){var a=w(e.rank,"white"===e.player?1:-1);t.positionLookup.get("".concat(e.file).concat(a))||e.possibleMoves.push({movedPieces:[{piece:e,from:[e.file,e.rank],to:[e.file,a]}],capturedPieces:[]})}}},{name:"Pawn Standard Capture",pieceType:"pawn",apply:function(e,t){var n=w(e.rank,"white"===e.player?1:-1),a=[],i=j(e.file,-1);i&&a.push([i,n]),(i=j(e.file,1))&&a.push([i,n]),a.forEach((function(n){var a=Object(p.a)(n,2),i=a[0],r=a[1],c=t.positionLookup.get("".concat(i).concat(r));c&&c.player!==e.player&&e.possibleMoves.push({movedPieces:[{piece:e,from:[e.file,e.rank],to:[i,r]}],capturedPieces:[c]})}))}},{name:"Pawn En Passant Capture",pieceType:"pawn",apply:function(e,t){var n="white"===e.player?5:4;if(e.rank===n){var a=[],i=j(e.file,-1);i&&a.push([i,n]),(i=j(e.file,1))&&a.push([i,n]),a.forEach((function(n){var a=Object(p.a)(n,2),i=a[0],r=a[1],c=t.positionLookup.get("".concat(i).concat(r));if(c&&1===c.moveHistory.length){var o=c.moveHistory[c.moveHistory.length-1],s=t.history[t.history.length-1];o===s&&(null===s||void 0===s?void 0:s.movedPieces[0].piece)===c&&e.possibleMoves.push({movedPieces:[{piece:e,from:[e.file,e.rank],to:[i,"white"===e.player?6:3]}],capturedPieces:[c]})}}))}}},{name:"Knight Standard Movement",pieceType:"knight",apply:function(e,t){[[j(e.file,-1),w(e.rank,2)],[j(e.file,1),w(e.rank,2)],[j(e.file,-2),w(e.rank,1)],[j(e.file,2),w(e.rank,1)],[j(e.file,-2),w(e.rank,-1)],[j(e.file,2),w(e.rank,-1)],[j(e.file,-1),w(e.rank,-2)],[j(e.file,1),w(e.rank,-2)]].filter((function(e){return!!e[0]&&!!e[1]})).forEach((function(n){var a=Object(p.a)(n,2),i=a[0],r=a[1],c=t.positionLookup.get("".concat(i).concat(r));c&&c.player===e.player||e.possibleMoves.push({movedPieces:[{piece:e,from:[e.file,e.rank],to:[i,r]}],capturedPieces:c?[c]:[]})}))}},{name:"Rook Standard Movement",pieceType:"rook",apply:function(e,t){var n;(n=e.possibleMoves).push.apply(n,Object(d.a)(C(e,t,[1,0,8],[-1,0,8],[0,1,8],[0,-1,8])))}},{name:"Bishop Standard Movement",pieceType:"bishop",apply:function(e,t){var n;(n=e.possibleMoves).push.apply(n,Object(d.a)(C(e,t,[1,1,8],[-1,1,8],[1,-1,8],[-1,-1,8])))}},{name:"Queen Standard Movement",pieceType:"queen",apply:function(e,t){var n;(n=e.possibleMoves).push.apply(n,Object(d.a)(C(e,t,[1,0,8],[-1,0,8],[0,1,8],[0,-1,8],[1,1,8],[-1,1,8],[1,-1,8],[-1,-1,8])))}},{name:"King Standard Movement",pieceType:"king",apply:function(e,t){var n;(n=e.possibleMoves).push.apply(n,Object(d.a)(C(e,t,[1,0,1],[-1,0,1],[0,1,1],[0,-1,1],[1,1,1],[-1,1,1],[1,-1,1],[-1,-1,1])))}},{name:"King Castle",pieceType:"king",apply:function(e,t){if(!(e.moveHistory.length>0)){var n="white"===e.player?1:8,a=t.positionLookup.get("h".concat(n));if(a&&0===a.moveHistory.length)if(![t.positionLookup.get("f".concat(n)),t.positionLookup.get("g".concat(n))].some((function(e){return e})))t.activePieces.filter((function(t){return t.player!==e.player})).some((function(e){return e.possibleMoves.some((function(e){var t=Object(p.a)(e.movedPieces,1),a=Object(p.a)(t[0].to,2),i=a[0],r=a[1];return"f"===i&&r===n}))}))||e.possibleMoves.push({movedPieces:[{piece:e,from:[e.file,e.rank],to:["g",n]},{piece:a,from:[a.file,a.rank],to:["f",n]}],capturedPieces:[]});if((a=t.positionLookup.get("a".concat(n)))&&0===a.moveHistory.length)if(![t.positionLookup.get("b".concat(n)),t.positionLookup.get("c".concat(n)),t.positionLookup.get("d".concat(n))].some((function(e){return e})))t.activePieces.filter((function(t){return t.player!==e.player})).some((function(e){return e.possibleMoves.some((function(e){var t=Object(p.a)(e.movedPieces,1),a=Object(p.a)(t[0].to,2),i=a[0],r=a[1];return"d"===i&&r===n}))}))||e.possibleMoves.push({movedPieces:[{piece:e,from:[e.file,e.rank],to:["c",n]},{piece:a,from:[a.file,a.rank],to:["d",n]}],capturedPieces:[]})}}}],g=function(){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];Object.freeze(t);var a=new Set(t),i=function(e){return a.has(e)},r={guard:i,values:t};return Object.freeze(r)}},m=(g()("white","black"),g()(1,2,3,4,5,6,7,8)),j=(g()("a","b","c","d","e","f","g","h"),function(e,t){return Object(h.match)([e,t]).with(["a",0],["b",-1],["c",-2],["d",-3],["e",-4],["f",-5],["g",-6],["h",-7],(function(){return"a"})).with(["a",1],["b",0],["c",-1],["d",-2],["e",-3],["f",-4],["g",-5],["h",-6],(function(){return"b"})).with(["a",2],["b",1],["c",0],["d",-1],["e",-2],["f",-3],["g",-4],["h",-5],(function(){return"c"})).with(["a",3],["b",2],["c",1],["d",0],["e",-1],["f",-2],["g",-3],["h",-4],(function(){return"d"})).with(["a",4],["b",3],["c",2],["d",1],["e",0],["f",-1],["g",-2],["h",-3],(function(){return"e"})).with(["a",5],["b",4],["c",3],["d",2],["e",1],["f",0],["g",-1],["h",-2],(function(){return"f"})).with(["a",6],["b",5],["c",4],["d",3],["e",2],["f",1],["g",0],["h",-1],(function(){return"g"})).with(["a",7],["b",6],["c",5],["d",4],["e",3],["f",2],["g",1],["h",0],(function(){return"h"})).otherwise((function(){}))}),w=function(e,t){return m.guard(e+t)?e+t:void 0},P=(g()(-1,0,1),function(){var e=Object(p.a)(["white","black"],2),t=e[0],n=e[1];return{getCurrent:function(){return t},toggle:function(){var e=[n,t];t=e[0],n=e[1]}}}),O=function(e,t,n,a){var i,r=Object(p.a)(t,2),c=r[0],o=r[1],s=Object(p.a)(n,2),l=s[0],u=s[1];a=null!==(i=a)&&void 0!==i?i:8;for(var f=[],d=j(c,l),b=w(o,u),h=e.positionLookup.get("".concat(d).concat(b)),v=0;d&&b&&v<a&&(f.push([d,b,h]),!h);)d=j(d,l),b=w(b,u),h=e.positionLookup.get("".concat(d).concat(b)),v++;return f},C=function(e,t){for(var n=arguments.length,a=new Array(n>2?n-2:0),i=2;i<n;i++)a[i-2]=arguments[i];return y(a.map((function(n){var a=Object(p.a)(n,3),i=a[0],r=a[1],c=a[2];return O(t,[e.file,e.rank],[i,r],c).map((function(t){var n=Object(p.a)(t,3),a=n[0],i=n[1],r=n[2];if((null===r||void 0===r?void 0:r.player)!==e.player)return{movedPieces:[{from:[e.file,e.rank],to:[a,i],piece:e}],capturedPieces:r?[r]:[]}})).filter((function(e){return"undefined"!==typeof e}))})))},M=n.p+"static/media/bb.98d23d98.svg",_=n.p+"static/media/bk.5b14c13b.svg",T=n.p+"static/media/bn.cc818957.svg",L=n.p+"static/media/bp.65485e34.svg",x=n.p+"static/media/bq.310fe3e2.svg",B=n.p+"static/media/br.c1b2c61e.svg",E=n.p+"static/media/wb.74b69dd8.svg",S=n.p+"static/media/wk.a1e6563d.svg",A=n.p+"static/media/wn.2b02b8b3.svg",H=n.p+"static/media/wp.7fbab4ab.svg",F=n.p+"static/media/wq.e195644e.svg",N=n.p+"static/media/wr.8825896f.svg",q=(a={pawn:[H,L],rook:[N,B],knight:[A,T],bishop:[E,M],queen:[F,x],king:[S,_]},function(e,t){return a[e]?Object(s.jsx)("img",{src:"white"===t?a[e][0]:a[e][1],alt:"".concat(t," ").concat(e)}):null}),z={a:1,b:2,c:3,d:4,e:5,f:6,g:7,h:8},I=function(){var e=Object(i.useMemo)((function(){return function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a={activePieces:(n?v:[]).concat(null!==e&&void 0!==e?e:[]).map((function(e){return Object(b.a)(Object(b.a)({},e),{},{possibleMoves:[],moveHistory:[]})})),capturedPieces:[],positionLookup:new Map,history:[],player:P()},i=Object.freeze((n?k:[]).concat(null!==t&&void 0!==t?t:[])),r=function(){a.positionLookup.clear(),a.activePieces.forEach((function(e){a.positionLookup.set("".concat(e.file).concat(e.rank),e),e.possibleMoves=[]})),i.forEach((function(e){var t=e.pieceType,n=e.apply;return a.activePieces.filter((function(e){return e.type===t})).forEach((function(e){return n(e,a)}))}))};return r(),{getPlayerTurn:function(){return a.player.getCurrent()},getCapturedPieces:function(){return Object.freeze(Object(d.a)(a.capturedPieces))},getPieceTypeAtPosition:function(e,t){var n=a.positionLookup.get("".concat(e).concat(t));return n&&[n.type,n.player]},getPossibleMovesAtPosition:function(e,t){var n=a.positionLookup.get("".concat(e).concat(t));return n&&n.player===a.player.getCurrent()?Object.freeze(Object(d.a)(n.possibleMoves)):[]},movePiece:function(e,t,n,i){var c=a.positionLookup.get("".concat(e).concat(t));if(!c)return!1;var o=c.possibleMoves.find((function(e){return e.movedPieces[0].piece===c&&e.movedPieces[0].to[0]===n&&e.movedPieces[0].to[1]===i}));return!!o&&(o.movedPieces.forEach((function(e){var t=e.piece,n=Object(p.a)(e.to,2),a=n[0],i=n[1];t.file=a,t.rank=i})),o.capturedPieces.forEach((function(e){a.activePieces.splice(a.activePieces.indexOf(e),1),a.capturedPieces.push(e)})),a.history.push(o),c.moveHistory.push(o),a.player.toggle(),r(),!0)},undo:function(){var e=a.history.pop();return!!e&&(e.capturedPieces.forEach((function(e){a.capturedPieces.splice(a.capturedPieces.indexOf(e),1),a.activePieces.push(e)})),e.movedPieces.forEach((function(e,t){var n=e.piece,a=Object(p.a)(e.from,2),i=a[0],r=a[1];0===t&&n.moveHistory.pop(),n.file=i,n.rank=r})),a.player.toggle(),r(),!0)}}}()}),[]),t=Object(i.useCallback)(q,[]),n=Object(i.useState)(),a=Object(p.a)(n,2),r=a[0],c=a[1],o=Object(i.useState)([]),s=Object(p.a)(o,2),l=s[0],u=s[1],f=Object(i.useState)(1),h=Object(p.a)(f,2),y=h[0],g=h[1];return{getPositionProperties:function(n,a){var i,r,c=null!==(i=null===(r=l.find((function(e){var t=Object(p.a)(e,2),i=t[0],r=t[1];return i===n&&r===a})))||void 0===r?void 0:r[2])&&void 0!==i?i:(z[n]+a)%2===0?"brown":"beige",o=e.getPieceTypeAtPosition(n,a);return{backgroundColor:c,renderedPiece:o?t.apply(void 0,Object(d.a)(o)):null}},selectPosition:function(t,n){if(r)e.movePiece.apply(e,Object(d.a)(r).concat([t,n]))&&g(y+1),c(void 0),u([]);else{var a=e.getPieceTypeAtPosition(t,n);if(!a||a[1]!==e.getPlayerTurn())return;var i=e.getPossibleMovesAtPosition(t,n);if(0===i.length)return;var o=[],s=[];i.forEach((function(e){o.push.apply(o,Object(d.a)(e.capturedPieces.map((function(e){return[e.file,e.rank,"red"]}))));var t=Object(p.a)(e.movedPieces,1)[0];s.push([].concat(Object(d.a)(t.to),["cyan"]))})),c([t,n]),u([[t,n,"green"]].concat(o,s))}},undo:function(){e.undo()&&g(y-1)},turnNumber:y,playerTurn:e.getPlayerTurn()}},R=function(){var e=I(),t=Object(i.useState)(!0),n=Object(p.a)(t,2),a=n[0],r=n[1];return Object(s.jsxs)("div",{className:"App",children:[Object(s.jsxs)("div",{className:"App__Info",children:[Object(s.jsxs)("h3",{children:["Turn: ",e.playerTurn]}),Object(s.jsxs)("label",{htmlFor:"perspectiveEnabled",children:[Object(s.jsx)("input",{type:"checkbox",id:"perspectiveEnabled",checked:a,onChange:function(){return r(!a)}}),"Enable Perspective Flip"]}),Object(s.jsx)("button",{onClick:e.undo,children:"Undo"})]}),Object(s.jsx)(f,{onCellClick:e.selectPosition,chessGame:e,perspective:a?e.playerTurn:"white"})]})},K=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,29)).then((function(t){var n=t.getCLS,a=t.getFID,i=t.getFCP,r=t.getLCP,c=t.getTTFB;n(e),a(e),i(e),r(e),c(e)}))};o.a.render(Object(s.jsx)(r.a.StrictMode,{children:Object(s.jsx)(R,{})}),document.getElementById("root")),K()}},[[28,1,2]]]);
//# sourceMappingURL=main.836f00ae.chunk.js.map